import{u as O,a as k,r as v,b as L,c as t,F as E,j as e}from"./app.9358082c.js";import{c as x}from"./index.0579b088.js";import{A as R}from"./ActionMessage.dc4f58bc.js";import{A as Y}from"./Modal.4610b35a.js";import{C as D}from"./Checkbox.6b59a25b.js";import{C as T}from"./ConfirmationModal.a506a9b4.js";import{D as q}from"./DangerButton.7ece74dd.js";import{D as i}from"./DialogModal.0bf617cc.js";import{F as z}from"./FormSection.1b31c292.js";import{T as G,I as H}from"./TextInput.111922b6.js";import{I as F}from"./InputLabel.6bc08a6a.js";import{P as d}from"./PrimaryButton.39fac1a9.js";import{S as C}from"./SecondaryButton.4830e97b.js";import{S as J}from"./SectionBorder.b25c6701.js";import"./transition.0fdee8b2.js";import"./SectionTitle.07fd502b.js";function le({tokens:y,availablePermissions:o,defaultPermissions:P}){var A,N,S;const m=O(),n=k({name:"",permissions:P}),r=k({permissions:[]}),u=k({}),[I,p]=v.exports.useState(!1),[h,l]=v.exports.useState(null),[g,c]=v.exports.useState(null),b=L();function w(){n.post(m("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{p(!0),n.reset()}})}function B(s){r.setData("permissions",s.abilities),l(s)}function M(){!h||r.put(m("api-tokens.update",[h]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>l(null)})}function j(s){c(s)}function _(){!g||u.delete(m("api-tokens.destroy",[g]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>c(null)})}return t("div",{children:[t(z,{onSubmit:w,title:"Create API Token",description:"API tokens allow third-party services to authenticate with our application on your behalf.",renderActions:()=>t(E,{children:[e(R,{on:n.recentlySuccessful,className:"mr-3",children:"Created."}),e(d,{className:x({"opacity-25":n.processing}),disabled:n.processing,children:"Create"})]}),children:[t("div",{className:"col-span-6 sm:col-span-4",children:[e(F,{htmlFor:"name",children:"Name"}),e(G,{id:"name",type:"text",className:"mt-1 block w-full",value:n.data.name,onChange:s=>n.setData("name",s.currentTarget.value),autoFocus:!0}),e(H,{message:n.errors.name,className:"mt-2"})]}),o.length>0&&t("div",{className:"col-span-6",children:[e(F,{htmlFor:"permissions",children:"Permissions"}),e("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(s=>e("div",{children:t("label",{className:"flex items-center",children:[e(D,{value:s,checked:n.data.permissions.includes(s),onChange:a=>{n.data.permissions.includes(a.currentTarget.value)?n.setData("permissions",n.data.permissions.filter(f=>f!==a.currentTarget.value)):n.setData("permissions",[a.currentTarget.value,...n.data.permissions])}}),e("span",{className:"ml-2 text-sm text-slate-600",children:s})]})},s))})]})]}),y.length>0?t("div",{children:[e(J,{}),e("div",{className:"mt-10 sm:mt-0",children:e(Y,{title:"Manage API Tokens",description:"You may delete any of your existing tokens if they are no longer needed.",children:e("div",{className:"space-y-6",children:y.map(s=>t("div",{className:"flex items-center justify-between",children:[e("div",{children:s.name}),t("div",{className:"flex items-center",children:[s.last_used_ago&&t("div",{className:"text-sm text-slate-400",children:["Last used ",s.last_used_ago]}),o.length>0?e(d,{className:"cursor-pointer ml-6 text-sm text-slate-400 underline",onClick:()=>B(s),children:"Permissions"}):null,e(d,{className:"cursor-pointer ml-6 text-sm text-red-500",onClick:()=>j(s),children:"Delete"})]})]},s.id))})})})]}):null,t(i,{isOpen:I,onClose:()=>p(!1),children:[t(i.Content,{title:"API Token",children:[e("div",{children:"Please copy your new API token. For your security, it won't be shown again."}),e("div",{className:"mt-4 bg-slate-100 px-4 py-2 rounded font-mono text-sm text-slate-500",children:(S=(N=(A=b.props)==null?void 0:A.jetstream)==null?void 0:N.flash)==null?void 0:S.token})]}),e(i.Footer,{children:e(C,{onClick:()=>p(!1),children:"Close"})})]}),t(i,{isOpen:!!h,onClose:()=>l(null),children:[e(i.Content,{title:"API Token Permissions",children:e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(s=>e("div",{children:t("label",{className:"flex items-center",children:[e(D,{value:s,checked:r.data.permissions.includes(s),onChange:a=>{r.data.permissions.includes(a.currentTarget.value)?r.setData("permissions",r.data.permissions.filter(f=>f!==a.currentTarget.value)):r.setData("permissions",[a.currentTarget.value,...r.data.permissions])}}),e("span",{className:"ml-2 text-sm text-slate-600",children:s})]})},s))})}),t(i.Footer,{children:[e(C,{onClick:()=>l(null),children:"Cancel"}),e(d,{onClick:M,className:x("ml-2",{"opacity-25":r.processing}),disabled:r.processing,children:"Save"})]})]}),t(T,{isOpen:!!g,onClose:()=>c(null),children:[e(T.Content,{title:"Delete API Token",children:"Are you sure you would like to delete this API token?"}),t(T.Footer,{children:[e(C,{onClick:()=>c(null),children:"Cancel"}),e(q,{onClick:_,className:x("ml-2",{"opacity-25":u.processing}),disabled:u.processing,children:"Delete"})]})]})]})}export{le as default};
